<div>
  <!-- loading spinner -->
  <div>
    <input type="text" [(ngModel)]="searchParams" placeholder="Search by email or display name...">
    <table>
      <tr>
        <th>Display Name</th>
        <th>Email Address</th>
        <th>Reset Password</th>
        <th>Roles</th>
        <th>Activity</th>
        <th>Login History</th>
      </tr>
      <tr *ngFor="let user of users | searchPipe: searchParams">
        <td>
          <div>
            <p>{{ user.name }}</p>
            <button 
              (click)="enableEditDisplayNameMode(user)" 
              type="button">
                Edit
            </button>
          </div>
          <div *ngIf="editDIsplayNameMode && currentUser.email == user.email">
            <form [formGroup]="ChangeDisplayName" (ngSubmit)="editDisplayName(ChangeDisplayName)">
              <div>
                <input type="name" formControlName="name" placeholder="Enter display name...">
              </div>
              <div>
                <button type="submit">Submit</button>
                <button type="button" (click)="resetDisplayNameForm()">Cancel</button>
              </div>
            </form>
          </div>
        </td>
        <td>
          {{ user.email }}
        </td>
        <td>
          <button 
            type="button"
            [disabled]="disabledResetPasswordButton && currentUser.email == user.email" 
            (click)="resetPassword(user)">
              Reset Password
          </button>
        </td>
        <td>
          <div>
            <div>
              <label *ngFor="let role of user.roles">           
                <input 
                  type="checkbox" disabled checked>
                  {{ role.name }}
              </label>    
            </div>
            <div>
              <button type="button" (click)="enableChangeRolesMode()">Edit</button>
            </div>
          </div>
          <div *ngIf="changeRolesMode">
            <form [formGroup]="changeRolesForm" (ngSubmit)="changeRolesSubmit(changeRolesForm, user)">
              <div>
                
              </div>
              <div>
                <button type="submit">Submit</button>
                <button type="button">Cancel</button>
              </div>
            </form>
          </div>
        </td>
        <td>
          <button 
            type="button" 
            *ngIf="!user.active" 
            (click)="changeAccountActivity(user.uid, true)">
              Activate
          </button>
          <button 
            type="button" 
            *ngIf="user.active" 
            (click)="changeAccountActivity(user.uid, false)">
              Deactivate
          </button>
        </td>
        <td>
          <button type="button">Last 10 logins</button>
        </td>
      </tr>
    </table>
  </div>

  <div *ngIf="resetPasswordPopUp">
    <p>
      Reset password email was successfully sent to {{currentUser.email}}!
    </p>
    <button type="button" (click)="closeResetPasswordPopUp()">Close</button>
  </div>
</div>