<div class="chats">
  <div class="chats__pending">
    <p class="chats__title">Pending chats</p>
    <div>
      <div *ngFor="let domainEl of activeChats">
        <div>
          <p>{{ domainEl.domainDescription }}</p>
        </div>
        <div>
          <div *ngFor="let chat of domainEl.chats">
            <div *ngIf="chat.status == 'pending'">
              <p>{{ chat.username }}</p>
              <p>{{ chat.option }}</p>
              <div>
                <button type="button" (click)="acceptChat(chat)">Accept</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="chats__chats">
    <p class="chats__title">Chats</p>
    <div>
      <div *ngFor="let domainEl of activeChats">
        <div *ngFor="let chat of domainEl.chats">
          <div             
            class="chats__chats__nav" 
            *ngIf="chat.status == 'active' && chat.operatorEmail == user?.email">
            <div [ngClass]="{'active-chat' : chat.id == activeChat}" class="chats__chats__nav__chat-info" (click)="setActiveChat(chat.id)">
              <p><span>user:</span> {{ chat.username }}</p>
              <p><span>option:</span> {{ chat.option }}</p>
              <p><span>domain:</span> {{ chat.domain }}</p>
            </div>
            <div class="chats__chats__content" *ngIf="chat.id == activeChat">
              <div>
                <div class="chats__chats__content__chat-history">
                  <app-chat-form-history [chatHistory]="chat.chatHistory"></app-chat-form-history>
                </div>
                <div>
                  <app-chat-form [userInfo]="{nick: chat.operatorDisplayName, chatId: chat.id, domain: chat.domain}"></app-chat-form>
                </div>
              </div>
              <div>
                <p>Client's info</p>
                <div>
                  <p>{{ chat.clientInformation[0].ip }}</p>
                  <p>{{ chat.clientInformation[0].city }}</p>
                  <p>{{ chat.clientInformation[0].country }}</p>
                  <div>
                    <button type="button" (click)="enableBlockOptio()" *ngIf="!isBlockOptionActive">Block client</button>
                    <form
                      *ngIf="isBlockOptionActive"
                      [formGroup]="blockForm" 
                      (ngSubmit)="submitBlockForm(chat, blockForm)">
                      <textarea formControlName="reason" placeholder="Blocking reason..."></textarea>
                      <div>
                        <button type="submit" [disabled]="blockForm.invalid">Block</button>
                        <button type="button" (click)="cancelBLokcOption()">Close</button>
                      </div>
                    </form>                   
                  </div>
                  <div>
                    <button *ngIf="!isCloseChatPopUpAcive" type="button" (click)="enableChatPopUp()">Close Chat</button>
                    <div *ngIf="isCloseChatPopUpAcive">
                      <p>–êre you sure you want to close this chat?</p>
                      <div>
                        <button (click)="closeChat(chat)">Yes</button>
                        <button (click)="disableCloseChatOption()">No</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>